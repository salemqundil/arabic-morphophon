"""
ğŸ§¬ Arabic Phoneme Weight Map Service,
    Interactive mapping between phonemes and morphological patterns
"""

# pylint: disable=broad-except,unused-variable,too-many-arguments
# pylint: disable=too-few-public-methods,invalid-name,unused-argument
# flake8: noqa: E501,F401,F821,A001,F403
# mypy: disable-error-code=no-untyped def,misc
    import json  # noqa: F401
    from typing import Dict, List, Optional, Tuple
    from dataclasses import dataclass, asdict  # noqa: F401
    from collections import defaultdict  # noqa: F401


@dataclass,
    class PhonemeMapping:
    """Data class for phoneme characteristics"""

    letter: str,
    articulation_point: str  # Ø§Ù„Ù…Ø®Ø±Ø¬,
    common_position: str  # Ø§Ù„Ù…ÙˆÙ‚Ø¹_Ø§Ù„Ø£Ø´ÙŠØ¹,
    common_patterns: List[str]  # Ø§Ù„Ø£ÙˆØ²Ø§Ù†_Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©,
    behavior: str  # Ø§Ù„Ø³Ù„ÙˆÙƒ,
    frequency: str  # ØªÙˆØ§ØªØ±_Ø§Ù„Ø¸Ù‡ÙˆØ±,
    phonetic_impact: str  # Ø§Ù„ØªØ£Ø«ÙŠØ±_Ø§Ù„ØµÙˆØªÙŠ,
    description: str  # Ø§Ù„ÙˆØµÙ,
    class PhonemeWeightMapService:
    """Service for managing phoneme pattern relationships"""

    def __init__(self):  # type: ignore[no-untyped def]
        """TODO: Add docstring."""
        self.phoneme_map = self._initialize_phoneme_map()
        self.pattern_weights = self._calculate_pattern_weights()

    def _initialize_phoneme_map(self) -> Dict[str, PhonemeMapping]:
        """Initialize the complete phoneme mapping from Arabic alphabet - alphabetically ordered"""

        phoneme_data = [
            {
                "letter": "Ø£",
                "articulation_point": "Ø­Ù„Ù‚ÙŠ",
                "common_position": "Ø¨Ø¯Ø§ÙŠØ©",
                "common_patterns": ["Ø£ÙÙÙ’Ø¹ÙÙ„Ù", "Ø¥ÙÙÙ’Ø¹ÙØ§Ù„", "ÙÙØ¹Ù’Ù„Ø§Ù†"],
                "behavior": "Ù…Ø­ÙØ²/Ø¨Ø§Ø¯Ø¦",
                "frequency": "Ù…Ø±ØªÙØ¹ ÙÙŠ Ø§Ù„Ù…Ø²ÙŠØ¯",
                "phonetic_impact": "Ù‚Ø§Ø·Ø¹/Ù…ÙØªÙˆØ­",
                "description": "ÙŠÙØªØ­ Ø§Ù„ØªØ±ÙƒÙŠØ¨ Ø§Ù„ØµØ±ÙÙŠ ÙˆÙŠÙˆØ¬Ù‡ Ù†Ø­Ùˆ Ø§Ù„ØªØ¹Ø¯ÙŠØ©",
            },
            {
                "letter": "Ø§",
                "articulation_point": "ÙÙ…ÙŠ",
                "common_position": "ÙˆØ³Ø· Ø§Ù„ÙˆØ²Ù†",
                "common_patterns": ["ÙÙØ§Ø¹ÙÙ„Ù", "ÙÙØ¹ÙØ§Ù„ÙØ©", "ÙÙØ¹ÙØ§Ù„ÙØ©"],
                "behavior": "Ù„ÙŠÙ†/Ù…Ù…Ø¯ÙˆØ¯",
                "frequency": "Ø´Ø§Ø¦Ø¹",
                "phonetic_impact": "Ù…Ø¯ÙŠ/ÙˆØ§Ø³Ø¹",
                "description": "ÙŠÙˆØ³Ø¹ Ø§Ù„Ù…Ù‚Ø·Ø¹ ÙˆÙŠØ®Ù„Ù‚ Ø¥ÙŠÙ‚Ø§Ø¹Ù‹Ø§ ØµØ±ÙÙŠÙ‹Ø§ Ù…Ù…ÙŠØ²Ù‹Ø§",
            },
            {
                "letter": "Ø¨",
                "articulation_point": "Ø´ÙÙˆÙŠ",
                "common_position": "Ù„Ø§Ù…",
                "common_patterns": ["ÙÙØ¹ÙÙ„Ù", "ÙÙØ¹ÙÙ‘Ù„Ù", "Ù…ÙÙÙ’Ø¹ÙÙˆÙ„", "Ù…ÙÙÙ’Ø¹ÙØ§Ù„"],
                "behavior": "Ù…Ø³ØªÙ‚Ø±/Ø«Ù‚ÙŠÙ„",
                "frequency": "Ù…Ø±ØªÙØ¹",
                "phonetic_impact": "Ù‚ÙˆÙŠ/ØµÙˆØª Ø§Ù†ÙØ¬Ø§Ø±ÙŠ",
                "description": "ØµØ§Ù…Øª Ù‚ÙˆÙŠ ÙŠÙØ³ØªØ®Ø¯Ù… ØºØ§Ù„Ø¨Ø§Ù‹ ÙÙŠ Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø¬Ø°Ø±",
            },
            {
                "letter": "Øª",
                "articulation_point": "Ø·Ø±Ù Ø§Ù„Ù„Ø³Ø§Ù†",
                "common_position": "ÙÙ€/Ø¹Ù€",
                "common_patterns": ["ÙÙØ¹ÙÙ„Ù", "ÙÙØ§Ø¹ÙÙ„Ù", "Ù…ÙÙÙØ§Ø¹ÙÙ„", "ØªÙÙÙØ§Ø¹ÙÙ„Ù"],
                "behavior": "Ù…Ø±Ù†/Ù…Ø±Ø¨ÙˆØ·",
                "frequency": "Ù…Ø±ØªÙØ¹ Ø¬Ø¯Ø§Ù‹",
                "phonetic_impact": "Ù…Ø­ØªÙƒ Ù…ØªÙˆØ³Ù‘Ø·",
                "description": "ØµØ§Ù…Øª ØªÙØ§Ø¹Ù„ÙŠ Ù…ØªØ¹Ø¯Ø¯ Ø§Ù„Ø£Ø¯ÙˆØ§Ø±",
            },
            {
                "letter": "Ø«",
                "articulation_point": "Ø¨ÙŠÙ† Ø§Ù„Ø£Ø³Ù†Ø§Ù†",
                "common_position": "ÙØ§Ø¡ Ø£Ùˆ Ù„Ø§Ù…",
                "common_patterns": ["ÙÙØ¹ÙÙ„Ù", "Ù…ÙÙÙ’Ø¹ÙÙˆÙ„"],
                "behavior": "Ù†Ø§Ø¯Ø±/Ù…Ø­Ø¯ÙˆØ¯",
                "frequency": "Ù…Ù†Ø®ÙØ¶",
                "phonetic_impact": "Ù…Ø­ØªÙƒ Ø®ÙÙŠÙ",
                "description": "ØµØ§Ù…Øª Ù†Ø§Ø¯Ø± Ø§Ù„Ø§Ø³ØªØ¹Ù…Ø§Ù„ ÙÙŠ Ø§Ù„Ø¬Ø°ÙˆØ± Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©",
            },
            {
                "letter": "Ø¬",
                "articulation_point": "ÙˆØ³Ø· Ø§Ù„Ù„Ø³Ø§Ù†",
                "common_position": "ÙØ§Ø¡ Ø£Ùˆ Ø¹ÙŠÙ†",
                "common_patterns": ["ÙÙØ¹ÙÙ„Ù", "Ø£ÙÙÙ’Ø¹ÙÙ„Ù", "ÙÙØ§Ø¹ÙÙ„Ù"],
                "behavior": "Ù‚ÙˆÙŠ/Ù…ØªØ­Ø±Ùƒ",
                "frequency": "Ù…ØªÙˆØ³Ø·",
                "phonetic_impact": "Ø§Ù†ÙØ¬Ø§Ø±ÙŠ Ø£Ù…Ø§Ù…ÙŠ",
                "description": "ÙŠØ¯Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ø­Ø±ÙƒØ© ÙˆØ§Ù„ØªØ¬Ù…Ø¹",
            },
            {
                "letter": "Ø­",
                "articulation_point": "Ø­Ù„Ù‚",
                "common_position": "Ø¹ÙŠÙ† Ø£Ùˆ Ù„Ø§Ù…",
                "common_patterns": ["ÙÙØ¹ÙÙ„Ù", "ÙÙØ¹ÙÙŠÙ„", "ÙÙØ§Ø¹ÙÙ„"],
                "behavior": "Ù‡Ø§Ø¯Ø¦/Ù…Ø³ØªÙ…Ø±",
                "frequency": "Ù…ØªÙˆØ³Ø· Ø¥Ù„Ù‰ Ù…Ø±ØªÙØ¹",
                "phonetic_impact": "Ù…Ø­ØªÙƒ Ø­Ù„Ù‚ÙŠ",
                "description": "ÙŠØ¹Ø·ÙŠ Ù†Ø¹ÙˆÙ…Ø© ØµÙˆØªÙŠØ© ÙˆØ¯Ù„Ø§Ù„Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù‡Ø¯ÙˆØ¡",
            },
            {
                "letter": "Ø®",
                "articulation_point": "Ø­Ù„Ù‚",
                "common_position": "ÙØ§Ø¡ Ø£Ùˆ Ù„Ø§Ù…",
                "common_patterns": ["ÙÙØ¹ÙÙ„Ù", "Ø£ÙÙÙ’Ø¹ÙÙ„Ù"],
                "behavior": "Ø®Ø´Ù†/Ù…Ù…ÙŠØ²",
                "frequency": "Ù…Ù†Ø®ÙØ¶ Ø¥Ù„Ù‰ Ù…ØªÙˆØ³Ø·",
                "phonetic_impact": "Ù…Ø­ØªÙƒ Ø®Ø´Ù†",
                "description": "ÙŠØ¯Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø´ÙˆÙ†Ø© ÙˆØ§Ù„Ù‚ÙˆØ©",
            },
            {
                "letter": "Ø¯",
                "articulation_point": "Ø·Ø±Ù Ø§Ù„Ù„Ø³Ø§Ù†",
                "common_position": "ÙØ§Ø¡ Ø£Ùˆ Ø¹ÙŠÙ†",
                "common_patterns": ["ÙÙØ¹ÙÙ„Ù", "Ø£ÙÙÙ’Ø¹ÙÙ„Ù", "ØªÙÙÙØ§Ø¹ÙÙ„Ù"],
                "behavior": "Ù‚ÙˆÙŠ/ÙˆØ§Ø¶Ø­",
                "frequency": "Ù…ØªÙˆØ³Ø· Ø¥Ù„Ù‰ Ù…Ø±ØªÙØ¹",
                "phonetic_impact": "Ø§Ù†ÙØ¬Ø§Ø±ÙŠ ÙˆØ§Ø¶Ø­",
                "description": "ÙŠØ¯Ù„ Ø¹Ù„Ù‰ Ø§Ù„ÙˆØ¶ÙˆØ­ ÙˆØ§Ù„Ø­Ø³Ù…",
            },
            {
                "letter": "Ø°",
                "articulation_point": "Ø¨ÙŠÙ† Ø§Ù„Ø£Ø³Ù†Ø§Ù†",
                "common_position": "ÙØ§Ø¡ Ø£Ùˆ Ù„Ø§Ù…",
                "common_patterns": ["ÙÙØ¹ÙÙ„Ù", "Ø£ÙÙÙ’Ø¹ÙÙ„Ù"],
                "behavior": "Ù†Ø§Ø¯Ø±/Ù…Ù…ÙŠØ²",
                "frequency": "Ù…Ù†Ø®ÙØ¶",
                "phonetic_impact": "Ù…Ø­ØªÙƒ Ù…Ø¬Ù‡ÙˆØ±",
                "description": "ØµØ§Ù…Øª Ù†Ø§Ø¯Ø± Ù„Ù‡ Ø¯Ù„Ø§Ù„Ø© Ø®Ø§ØµØ©",
            },
            {
                "letter": "Ø±",
                "articulation_point": "Ø·Ø±Ù Ø§Ù„Ù„Ø³Ø§Ù†",
                "common_position": "Ø¹ÙŠÙ† Ø£Ùˆ Ù„Ø§Ù…",
                "common_patterns": ["ÙÙØ¹ÙÙ„Ù", "ÙÙØ¹ÙÙŠÙ„", "Ù…ÙÙÙ’Ø¹ÙÙˆÙ„"],
                "behavior": "Ù…ØªØ¯Ø­Ø±Ø¬/Ø­ÙŠÙˆÙŠ",
                "frequency": "Ù…Ø±ØªÙØ¹ Ø¬Ø¯Ø§Ù‹",
                "phonetic_impact": "ØªÙƒØ±Ø§Ø±ÙŠ/Ø±Ù†Ø§Ù†",
                "description": "ØµØ§Ù…Øª Ø´Ø§Ø¦Ø¹ Ø¬Ø¯Ø§Ù‹ ÙŠØ¹Ø·ÙŠ Ø­ÙŠÙˆÙŠØ© Ù„Ù„Ø¬Ø°Ø±",
            },
            {
                "letter": "Ø²",
                "articulation_point": "Ø£Ø³Ù†Ø§Ù†",
                "common_position": "ÙØ§Ø¡ Ø£Ùˆ Ø¹ÙŠÙ†",
                "common_patterns": ["ÙÙØ¹ÙÙ„Ù", "Ø£ÙÙÙ’Ø¹ÙÙ„Ù"],
                "behavior": "Ø­Ø§Ø¯/Ù…Ø¬Ù‡ÙˆØ±",
                "frequency": "Ù…ØªÙˆØ³Ø·",
                "phonetic_impact": "ØµÙÙŠØ±ÙŠ Ù…Ø¬Ù‡ÙˆØ±",
                "description": "ÙŠØ¯Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ø­Ø¯Ø© ÙˆØ§Ù„ÙˆØ¶ÙˆØ­",
            },
            {
                "letter": "Ø³",
                "articulation_point": "Ø£Ø³Ù†Ø§Ù†",
                "common_position": "ÙØ§Ø¡ Ø£Ùˆ Ù„Ø§Ù…",
                "common_patterns": ["Ø§Ø³Ù’ØªÙÙÙ’Ø¹ÙÙ„Ù", "ÙÙØ§Ø¹ÙÙ„Ù", "ÙÙØ¹ÙØ§Ù„"],
                "behavior": "Ø³ÙÙ„Ø³/Ù…Ø­Ø§ÙŠØ¯",
                "frequency": "Ù…Ø±ØªÙØ¹",
                "phonetic_impact": "ØµÙÙŠØ±ÙŠ Ù…Ø³ØªÙ…Ø±",
                "description": "ÙŠØªÙƒØ±Ø± ÙÙŠ Ø§Ù„Ø£ÙØ¹Ø§Ù„ Ø§Ù„Ø¹Ø§Ù…Ø© ÙˆØ§Ù„Ù…Ø¬Ø±Ø¯Ø©",
            },
            {
                "letter": "Ø´",
                "articulation_point": "ÙˆØ³Ø· Ø§Ù„Ù„Ø³Ø§Ù†",
                "common_position": "ÙØ§Ø¡ Ø£Ùˆ Ø¹ÙŠÙ†",
                "common_patterns": ["ÙÙØ¹ÙÙ„Ù", "Ø£ÙÙÙ’Ø¹ÙÙ„Ù", "ØªÙÙÙØ§Ø¹ÙÙ„Ù"],
                "behavior": "ÙˆØ§Ø³Ø¹/Ù…Ù†ØªØ´Ø±",
                "frequency": "Ù…ØªÙˆØ³Ø·",
                "phonetic_impact": "ØµÙÙŠØ±ÙŠ ÙˆØ§Ø³Ø¹",
                "description": "ÙŠØ¯Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ø§Ù†ØªØ´Ø§Ø± ÙˆØ§Ù„ÙˆØ¶ÙˆØ­",
            },
            {
                "letter": "Øµ",
                "articulation_point": "Ø·Ø±Ù Ø§Ù„Ù„Ø³Ø§Ù†",
                "common_position": "ÙØ§Ø¡ Ø£Ùˆ Ø¹ÙŠÙ†",
                "common_patterns": ["ÙÙØ¹ÙÙ„Ù", "Ø£ÙÙÙ’Ø¹ÙÙ„Ù", "ÙÙØ§Ø¹ÙÙ„Ù"],
                "behavior": "Ù…ÙØ®Ù…/Ù‚ÙˆÙŠ",
                "frequency": "Ù…ØªÙˆØ³Ø·",
                "phonetic_impact": "ØµÙÙŠØ±ÙŠ Ù…ÙØ®Ù…",
                "description": "ÙŠØ¶ÙÙŠ Ù‚ÙˆØ© ÙˆØªÙØ®ÙŠÙ…Ù‹Ø§ Ø¹Ù„Ù‰ Ø§Ù„Ø¬Ø°Ø±",
            },
            {
                "letter": "Ø¶",
                "articulation_point": "Ø¬Ø§Ù†Ø¨ Ø§Ù„Ù„Ø³Ø§Ù†",
                "common_position": "Ø¹ÙŠÙ† Ø£Ùˆ Ù„Ø§Ù…",
                "common_patterns": ["ÙÙØ¹ÙÙ„Ù", "Ø£ÙÙÙ’Ø¹ÙÙ„Ù", "Ø§Ù†Ù’ÙÙØ¹ÙÙ„Ù"],
                "behavior": "Ù…ÙØ®Ù…/Ù…Ù…ÙŠØ²",
                "frequency": "Ù…Ù†Ø®ÙØ¶ Ø¥Ù„Ù‰ Ù…ØªÙˆØ³Ø·",
                "phonetic_impact": "Ø¬Ø§Ù†Ø¨ÙŠ Ù…ÙØ®Ù…",
                "description": "ØµØ§Ù…Øª Ù…Ù…ÙŠØ² Ù„Ù„Ø¹Ø±Ø¨ÙŠØ© ÙŠØ¯Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ù‚ÙˆØ©",
            },
            {
                "letter": "Ø·",
                "articulation_point": "Ø·Ø±Ù Ø§Ù„Ù„Ø³Ø§Ù†",
                "common_position": "ÙØ§Ø¡ Ø£Ùˆ Ø¹ÙŠÙ†",
                "common_patterns": ["ÙÙØ¹ÙÙ„Ù", "Ø£ÙÙÙ’Ø¹ÙÙ„Ù", "ØªÙÙÙØ§Ø¹ÙÙ„Ù"],
                "behavior": "Ù…ÙØ®Ù…/Ø§Ù†ÙØ¬Ø§Ø±ÙŠ",
                "frequency": "Ù…ØªÙˆØ³Ø·",
                "phonetic_impact": "Ø§Ù†ÙØ¬Ø§Ø±ÙŠ Ù…ÙØ®Ù…",
                "description": "ÙŠØ¯Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ù‚ÙˆØ© ÙˆØ§Ù„ØªØ£Ø«ÙŠØ±",
            },
            {
                "letter": "Ø¸",
                "articulation_point": "Ø¨ÙŠÙ† Ø§Ù„Ø£Ø³Ù†Ø§Ù†",
                "common_position": "ÙØ§Ø¡ Ø£Ùˆ Ù„Ø§Ù…",
                "common_patterns": ["ÙÙØ¹ÙÙ„Ù", "Ø£ÙÙÙ’Ø¹ÙÙ„Ù"],
                "behavior": "Ù…ÙØ®Ù…/Ù†Ø§Ø¯Ø±",
                "frequency": "Ù…Ù†Ø®ÙØ¶",
                "phonetic_impact": "Ù…Ø­ØªÙƒ Ù…ÙØ®Ù…",
                "description": "ØµØ§Ù…Øª Ù†Ø§Ø¯Ø± Ù…ÙØ®Ù… Ù„Ù‡ Ø¯Ù„Ø§Ù„Ø© Ø®Ø§ØµØ©",
            },
            {
                "letter": "Ø¹",
                "articulation_point": "Ø­Ù„Ù‚",
                "common_position": "Ø¹ÙŠÙ† Ø£Ùˆ Ù„Ø§Ù…",
                "common_patterns": ["ÙÙØ¹ÙÙ„Ù", "ÙÙØ§Ø¹ÙÙ„Ù", "Ø£ÙÙÙ’Ø¹ÙÙ„Ù"],
                "behavior": "Ø¹Ù…ÙŠÙ‚/Ø­Ù„Ù‚ÙŠ",
                "frequency": "Ù…Ø±ØªÙØ¹",
                "phonetic_impact": "Ø­Ù„Ù‚ÙŠ Ø¹Ù…ÙŠÙ‚",
                "description": "ØµØ§Ù…Øª Ø­Ù„Ù‚ÙŠ Ù…Ù…ÙŠØ² ÙŠØ¹Ø·ÙŠ Ø¹Ù…Ù‚Ù‹Ø§ ØµÙˆØªÙŠÙ‹Ø§",
            },
            {
                "letter": "Øº",
                "articulation_point": "Ø­Ù„Ù‚",
                "common_position": "ÙØ§Ø¡ Ø£Ùˆ Ù„Ø§Ù…",
                "common_patterns": ["ÙÙØ¹ÙÙ„Ù", "Ø£ÙÙÙ’Ø¹ÙÙ„Ù", "ØªÙÙÙØ§Ø¹ÙÙ„Ù"],
                "behavior": "Ù…Ø¬Ù‡ÙˆØ±/Ù‚ÙˆÙŠ",
                "frequency": "Ù…ØªÙˆØ³Ø·",
                "phonetic_impact": "Ù…Ø­ØªÙƒ Ø­Ù„Ù‚ÙŠ Ù…Ø¬Ù‡ÙˆØ±",
                "description": "ÙŠØ¯Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ù‚ÙˆØ© ÙˆØ§Ù„ØªØºÙŠÙŠØ±",
            },
            {
                "letter": "Ù",
                "articulation_point": "Ø´ÙÙˆÙŠ Ø£Ø³Ù†Ø§Ù†ÙŠ",
                "common_position": "ÙØ§Ø¡ Ø£Ùˆ Ù„Ø§Ù…",
                "common_patterns": ["ÙÙØ¹ÙÙ„Ù", "Ø£ÙÙÙ’Ø¹ÙÙ„Ù", "ØªÙÙÙØ§Ø¹ÙÙ„Ù"],
                "behavior": "Ù…Ø­ØªÙƒ/Ø®ÙÙŠÙ",
                "frequency": "Ù…Ø±ØªÙØ¹",
                "phonetic_impact": "Ù…Ø­ØªÙƒ Ø®ÙÙŠÙ",
                "description": "ØµØ§Ù…Øª Ø´Ø§Ø¦Ø¹ ÙŠØ¯Ù„ Ø¹Ù„Ù‰ Ø§Ù„ÙØ¹Ù„ ÙˆØ§Ù„ØªØ£Ø«ÙŠØ±",
            },
            {
                "letter": "Ù‚",
                "articulation_point": "Ù„Ù‡ÙˆÙŠ",
                "common_position": "ÙØ§Ø¡ Ø£Ùˆ Ø¹ÙŠÙ†",
                "common_patterns": ["ÙÙØ¹ÙÙ„Ù", "Ø£ÙÙÙ’Ø¹ÙÙ„Ù", "ØªÙÙÙØ§Ø¹ÙÙ„Ù"],
                "behavior": "Ø§Ù†ÙØ¬Ø§Ø±ÙŠ/Ù‚ÙˆÙŠ",
                "frequency": "Ù…ØªÙˆØ³Ø· Ø¥Ù„Ù‰ Ù…Ø±ØªÙØ¹",
                "phonetic_impact": "Ø§Ù†ÙØ¬Ø§Ø±ÙŠ Ø®Ù„ÙÙŠ Ù‚ÙˆÙŠ",
                "description": "ÙŠØ¯Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ù‚ÙˆØ© ÙˆØ§Ù„Ø­Ø³Ù…",
            },
            {
                "letter": "Ùƒ",
                "articulation_point": "Ù„Ù‡ÙˆÙŠ",
                "common_position": "ÙØ§Ø¡",
                "common_patterns": ["ÙÙØ¹ÙÙ„Ù", "Ø£ÙÙÙ’Ø¹ÙÙ„Ù", "Ø§Ø³Ù’ØªÙÙÙ’Ø¹ÙÙ„Ù"],
                "behavior": "Ù…Ø³ØªÙ‚Ø±/Ø«Ù‚ÙŠÙ„",
                "frequency": "Ù…ØªÙˆØ³Ø·",
                "phonetic_impact": "Ø§Ù†ÙØ¬Ø§Ø±ÙŠ Ø®Ù„ÙÙŠ",
                "description": "ØµØ§Ù…Øª Ø®Ù„ÙÙŠ ÙŠØ¯Ù„ ØºØ§Ù„Ø¨Ù‹Ø§ Ø¹Ù„Ù‰ ÙØ¹Ù„ Ø­Ø³Ù‘ÙŠ",
            },
            {
                "letter": "Ù„",
                "articulation_point": "Ø·Ø±Ù Ø§Ù„Ù„Ø³Ø§Ù†",
                "common_position": "Ù„Ø§Ù… Ø£Ùˆ Ø¹ÙŠÙ†",
                "common_patterns": ["ÙÙØ¹ÙÙ„Ù", "ÙÙØ¹ÙÙŠÙ„", "Ù…ÙÙÙ’Ø¹ÙÙˆÙ„"],
                "behavior": "Ø³Ø§Ø¦Ù„/Ù…Ø³ØªÙ…Ø±",
                "frequency": "Ù…Ø±ØªÙØ¹ Ø¬Ø¯Ø§Ù‹",
                "phonetic_impact": "Ø¬Ø§Ù†Ø¨ÙŠ Ù…Ø³ØªÙ…Ø±",
                "description": "ØµØ§Ù…Øª Ø´Ø§Ø¦Ø¹ Ø¬Ø¯Ø§Ù‹ ÙŠØ¹Ø·ÙŠ Ø§Ø³ØªÙ…Ø±Ø§Ø±ÙŠØ©",
            },
            {
                "letter": "Ù…",
                "articulation_point": "Ø´ÙÙˆÙŠ",
                "common_position": "ÙØ§Ø¡ Ø£Ùˆ Ø¹ÙŠÙ†",
                "common_patterns": ["ÙÙØ¹ÙÙ„Ù", "Ù…ÙÙÙ’Ø¹ÙÙˆÙ„", "ÙÙØ§Ø¹ÙÙ„"],
                "behavior": "Ø£Ù†ÙÙŠ/Ù…Ø³ØªÙ…Ø±",
                "frequency": "Ù…Ø±ØªÙØ¹ Ø¬Ø¯Ø§Ù‹",
                "phonetic_impact": "Ø£Ù†ÙÙŠ Ø´ÙÙˆÙŠ",
                "description": "ØµØ§Ù…Øª Ø£Ù†ÙÙŠ Ø´Ø§Ø¦Ø¹ ÙŠØ¯Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ø§Ø³ØªÙ…Ø±Ø§Ø±",
            },
            {
                "letter": "Ù†",
                "articulation_point": "Ø®ÙŠØ´ÙˆÙ…",
                "common_position": "Ù„Ø§Ù… Ø£Ùˆ Ø£ÙˆÙ„ Ù…Ø²ÙŠØ¯",
                "common_patterns": ["Ø§Ù†Ù’ÙÙØ¹ÙÙ„Ù", "Ù…ÙÙ†Ù’ÙÙØ¹ÙÙ„", "Ø§Ø³Ù’ØªÙÙÙ’Ø¹ÙÙ„Ù"],
                "behavior": "Ù„ÙŠÙ†/ØªØ­ÙˆÙŠÙ„ÙŠ",
                "frequency": "Ù…ØªÙˆØ³Ø·",
                "phonetic_impact": "Ø£Ù†ÙÙŠ/Ù…Ø·Ø¨Ù‘Ù‚",
                "description": "Ø¹Ù†ØµØ± Ø¥Ø¶Ø§ÙÙŠ ÙŠØ¯Ù„ Ø¹Ù„Ù‰ Ø§Ù„ØªØºÙŠØ± ÙˆØ§Ù„ØªØ­ÙˆÙ„",
            },
            {
                "letter": "Ù‡",
                "articulation_point": "Ø­Ù†Ø¬Ø±Ø©",
                "common_position": "Ù„Ø§Ù… Ø£Ùˆ Ù‡Ø§Ø¡ Ø§Ù„Ø³ÙƒØª",
                "common_patterns": ["ÙÙØ¹ÙÙ„Ù", "Ø£ÙÙÙ’Ø¹ÙÙ„Ù"],
                "behavior": "Ø®ÙÙŠÙ/ØªÙ†ÙØ³ÙŠ",
                "frequency": "Ù…ØªÙˆØ³Ø·",
                "phonetic_impact": "ØªÙ†ÙØ³ÙŠ Ø®ÙÙŠÙ",
                "description": "ØµØ§Ù…Øª Ø®ÙÙŠÙ ÙŠØ¸Ù‡Ø± ÙÙŠ Ø§Ù„Ù†Ù‡Ø§ÙŠØ§Øª",
            },
            {
                "letter": "Ùˆ",
                "articulation_point": "Ø´ÙÙˆÙŠ",
                "common_position": "ÙˆØ³Ø· Ø£Ùˆ Ø¢Ø®Ø±",
                "common_patterns": ["ÙÙØ¹ÙÙˆÙ„", "ÙÙØ¹ÙÙˆÙ„", "Ù…ÙÙÙ’Ø¹ÙÙˆÙ„"],
                "behavior": "Ù„ÙŠÙ†/Ø®Ø§ØªÙ…",
                "frequency": "Ù…ØªÙˆØ³Ø·",
                "phonetic_impact": "Ù…ÙØªÙˆØ­/Ø±Ø§Ø¨Ø·",
                "description": "ØªØ¸Ù‡Ø± ÙÙŠ Ø§Ù„Ø®ÙˆØ§ØªÙŠÙ… Ø£Ùˆ Ø¹Ù†Ø¯ Ø§Ù„Ù…Ø¯ Ø§Ù„ØµÙˆØªÙŠ",
            },
            {
                "letter": "ÙŠ",
                "articulation_point": "ÙˆØ³Ø· Ø§Ù„Ù„Ø³Ø§Ù†",
                "common_position": "Ù„Ø§Ù… Ø£Ùˆ ÙØ§Ø¡",
                "common_patterns": ["ÙÙØ¹ÙÙŠÙ„", "ÙÙØ¹ÙØ§Ù„", "ÙÙØ¹Ù’Ù„ÙØ©"],
                "behavior": "Ù„ÙŠÙ†/ÙˆØ§ØµÙ„",
                "frequency": "Ù…ØªÙˆØ³Ø·",
                "phonetic_impact": "Ù…Ø§Ø¦Ù„/Ø±Ù‚ÙŠÙ‚",
                "description": "ÙŠØ¯Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ø§Ø³ØªÙ…Ø±Ø§Ø±ÙŠØ© ÙˆØ§Ù„ÙˆØµÙ",
            },
        ]

        return {data["letter"]: PhonemeMapping(**data) for data in phoneme_data}

    def _calculate_pattern_weights(self) -> Dict[str, float]:
        """Calculate weights for morphological patterns based on frequency"""
        pattern_counts = defaultdict(int)

        # Count pattern occurrences across all phonemes,
    for phoneme in self.phoneme_map.values():
            for pattern in phoneme.common_patterns:
                pattern_counts[pattern] += 1

        # Convert to normalized weights,
    max_count = max(pattern_counts.values()) if pattern_counts else 1,
    return {pattern: count / max_count for pattern, count in pattern_counts.items()}

    def get_phoneme_info(self, letter: str) -> Optional[PhonemeMapping]:
        """Get detailed information for a specific phoneme"""
        return self.phoneme_map.get(letter)

    def get_patterns_for_phoneme(self, letter: str) -> List[str]:
        """Get common patterns for a specific phoneme"""
        phoneme = self.phoneme_map.get(letter)
        return phoneme.common_patterns if phoneme else []

    def get_phonemes_for_pattern(self, pattern: str) -> List[str]:
        """Get phonemes that commonly use a specific pattern"""
        result = []
        for letter, phoneme in self.phoneme_map.items():
            if pattern in phoneme.common_patterns:
                result.append(letter)
        return result,
    def analyze_word_phonetic_structure(self, word: str) -> Dict:
        """Analyze the phonetic structure of a word"""
        analysis = {
            "word": word,
            "phoneme_breakdown": [],
            "predicted_patterns": [],
            "phonetic_characteristics": {
                "articulation_diversity": set(),
                "behavior_types": set(),
                "frequency_distribution": [],
            },
        }

        for char in word:
            if char in self.phoneme_map:
                phoneme = self.phoneme_map[char]
                analysis["phoneme_breakdown"].append(
                    {
                        "letter": char,
                        "articulation": phoneme.articulation_point,
                        "behavior": phoneme.behavior,
                        "frequency": phoneme.frequency,
                    }
                )

                analysis["phonetic_characteristics"]["articulation_diversity"].add(
                    phoneme.articulation_point
                )
                analysis["phonetic_characteristics"]["behavior_types"].add(
                    phoneme.behavior
                )
                analysis["phonetic_characteristics"]["frequency_distribution"].append(
                    phoneme.frequency
                )

                # Add common patterns for this phoneme,
    analysis["predicted_patterns"].extend(phoneme.common_patterns)

        # Convert sets to lists for JSON serialization,
    analysis["phonetic_characteristics"]["articulation_diversity"] = list(
            analysis["phonetic_characteristics"]["articulation_diversity"]
        )
        analysis["phonetic_characteristics"]["behavior_types"] = list(
            analysis["phonetic_characteristics"]["behavior_types"]
        )

        # Remove duplicate patterns and sort by weight,
    unique_patterns = list(set(analysis["predicted_patterns"]))
        analysis["predicted_patterns"] = sorted(
            unique_patterns, key=lambda p: self.pattern_weights.get(p, 0), reverse=True
        )

        return analysis,
    def get_interactive_map_data(self) -> List[Dict]:
        """Get data formatted for interactive display"""
        return [
            {
                "Ø§Ù„Ø­Ø±Ù": phoneme.letter,
                "Ø§Ù„Ù…Ø®Ø±Ø¬": phoneme.articulation_point,
                "Ø§Ù„Ù…ÙˆÙ‚Ø¹_Ø§Ù„Ø£Ø´ÙŠØ¹": phoneme.common_position,
                "Ø§Ù„Ø£ÙˆØ²Ø§Ù†_Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©": phoneme.common_patterns,
                "Ø§Ù„Ø³Ù„ÙˆÙƒ": phoneme.behavior,
                "ØªÙˆØ§ØªØ±_Ø§Ù„Ø¸Ù‡ÙˆØ±": phoneme.frequency,
                "Ø§Ù„ØªØ£Ø«ÙŠØ±_Ø§Ù„ØµÙˆØªÙŠ": phoneme.phonetic_impact,
                "Ø§Ù„ÙˆØµÙ": phoneme.description,
            }
            for phoneme in sorted(self.phoneme_map.values(), key=lambda x: x.letter)
        ]

    def search_patterns(self, query: str) -> List[Dict]:
        """Search for patterns and related phonemes"""
        results = []
        query_lower = query.lower()

        for letter, phoneme in self.phoneme_map.items():
            # Search in patterns,
    matching_patterns = [
                p for p in phoneme.common_patterns if query_lower in p.lower()
            ]

            if matching_patterns or query_lower in phoneme.behavior.lower():
                results.append(
                    {
                        "phoneme": letter,
                        "matching_patterns": matching_patterns,
                        "phoneme_info": asdict(phoneme),
                    }
                )

        return results,
    def get_phoneme_statistics(self) -> Dict:
        """Get statistical overview of the phoneme map"""
        stats = {
            "total_phonemes": len(self.phoneme_map),
            "total_patterns": len(self.pattern_weights),
            "articulation_points": defaultdict(int),
            "behavior_types": defaultdict(int),
            "frequency_levels": defaultdict(int),
            "most_common_patterns": [],
        }

        for phoneme in self.phoneme_map.values():
            stats["articulation_points"][phoneme.articulation_point] += 1,
    stats["behavior_types"][phoneme.behavior] += 1,
    stats["frequency_levels"][phoneme.frequency] += 1

        # Get most common patterns,
    stats["most_common_patterns"] = sorted(
            self.pattern_weights.items(), key=lambda x: x[1], reverse=True
        )[:10]

        return stats,
    def get_pandas_style_dataframe_data(self) -> List[Dict]:
        """
        Get phoneme data formatted as pandas DataFrame style for interactive display,
    Ø®Ø±ÙŠØ·Ø© ØªÙØ§Ø¹Ù„ÙŠØ© Ù…Ø±ØªØ¨Ø© Ø­Ø³Ø¨ Ø§Ù„Ø­Ø±Ù Ù…Ù† Ø£ Ø¥Ù„Ù‰ ÙŠ
        """
        dataframe_data = []

        # Sort phonemes alphabetically according to Arabic alphabet order,
    arabic_alphabet_order = [
            "Ø£",
            "Ø§",
            "Ø¨",
            "Øª",
            "Ø«",
            "Ø¬",
            "Ø­",
            "Ø®",
            "Ø¯",
            "Ø°",
            "Ø±",
            "Ø²",
            "Ø³",
            "Ø´",
            "Øµ",
            "Ø¶",
            "Ø·",
            "Ø¸",
            "Ø¹",
            "Øº",
            "Ù",
            "Ù‚",
            "Ùƒ",
            "Ù„",
            "Ù…",
            "Ù†",
            "Ù‡",
            "Ùˆ",
            "ÙŠ",
        ]

        for letter in arabic_alphabet_order:
            if letter in self.phoneme_map:
                phoneme = self.phoneme_map[letter]
                dataframe_data.append(
                    {
                        "Ø§Ù„Ø­Ø±Ù": phoneme.letter,
                        "Ø§Ù„Ù…Ø®Ø±Ø¬": phoneme.articulation_point,
                        "Ø§Ù„Ù…ÙˆÙ‚Ø¹_Ø§Ù„Ø£Ø´ÙŠØ¹": phoneme.common_position,
                        "Ø§Ù„Ø£ÙˆØ²Ø§Ù†_Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©": phoneme.common_patterns,
                        "Ø§Ù„Ø³Ù„ÙˆÙƒ": phoneme.behavior,
                        "ØªÙˆØ§ØªØ±_Ø§Ù„Ø¸Ù‡ÙˆØ±": phoneme.frequency,
                        "Ø§Ù„ØªØ£Ø«ÙŠØ±_Ø§Ù„ØµÙˆØªÙŠ": phoneme.phonetic_impact,
                        "Ø§Ù„ÙˆØµÙ": phoneme.description,
                    }
                )

        return dataframe_data,
    def create_interactive_phoneme_display(self) -> Dict:
        """
        Create an interactive display similar to ace_tools.display_dataframe_to_user
        """
        dataframe_data = self.get_pandas_style_dataframe_data()

        return {
            "title": "ğŸ§¬ Ø®Ø±ÙŠØ·Ø© ØªÙØ§Ø¹Ù„ÙŠØ© Ù…Ø±ØªØ¨Ø© Ø¨ÙŠÙ† Ø§Ù„ÙÙˆÙ†ÙŠÙ…Ø§Øª ÙˆØ§Ù„Ø£ÙˆØ²Ø§Ù† Ø§Ù„ØµØ±ÙÙŠØ©",
            "description": "Interactive mapping between Arabic phonemes and morphological patterns, sorted alphabetically",
            "data": dataframe_data,
            "metadata": {
                "total_entries": len(dataframe_data),
                "sorted_by": "Arabic alphabetical order (Ø£ Ø¥Ù„Ù‰ ÙŠ)",
                "columns": [
                    {"key": "Ø§Ù„Ø­Ø±Ù", "description": "Arabic Letter/Phoneme"},
                    {"key": "Ø§Ù„Ù…Ø®Ø±Ø¬", "description": "Articulation Point"},
                    {"key": "Ø§Ù„Ù…ÙˆÙ‚Ø¹_Ø§Ù„Ø£Ø´ÙŠØ¹", "description": "Most Common Position"},
                    {"key": "Ø§Ù„Ø£ÙˆØ²Ø§Ù†_Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©", "description": "Common Patterns"},
                    {"key": "Ø§Ù„Ø³Ù„ÙˆÙƒ", "description": "Phonetic Behavior"},
                    {"key": "ØªÙˆØ§ØªØ±_Ø§Ù„Ø¸Ù‡ÙˆØ±", "description": "Frequency of Occurrence"},
                    {"key": "Ø§Ù„ØªØ£Ø«ÙŠØ±_Ø§Ù„ØµÙˆØªÙŠ", "description": "Phonetic Impact"},
                    {"key": "Ø§Ù„ÙˆØµÙ", "description": "Description"},
                ],
                "language": "Arabic",
                "created_at": "2025-07 09",
                "version": "2.0",
            },
        }


# Global instance,
    phoneme_service = PhonemeWeightMapService()
