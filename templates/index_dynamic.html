<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>محرك التحليل الصوتي العربي الديناميكي - Dynamic Arabic Phonology Engine</title>
    
    <!-- External Libraries -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Amiri:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">
    
    <!-- Custom Styles -->
    <link href="{{ url_for('static', filename='css/style.css') }}" rel="stylesheet">
    
    <!-- SocketIO for real-time features -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.2/socket.io.js"></script>
</head>
<body>
    <!-- Connection Status Bar -->
    <div id="connectionStatus" class="connection-status">
        <div class="container-fluid d-flex justify-content-between align-items-center">
            <div class="connection-info">
                <i id="connectionIcon" class="fas fa-circle text-warning"></i>
                <span id="connectionText">جاري الاتصال... Connecting...</span>
            </div>
            <div class="server-stats">
                <span id="serverStats" class="small text-muted">إحصائيات الخادم</span>
            </div>
        </div>
    </div>

    <div class="container-fluid main-container">
        <!-- Enhanced Header with Real-time Stats -->
        <header class="bg-primary text-white p-4 mb-4 header-enhanced">
            <div class="row align-items-center">
                <div class="col-md-6">
                    <h1 class="display-4 mb-0">
                        <i class="fas fa-microphone-alt me-3"></i>
                        محرك التحليل الصوتي الديناميكي
                    </h1>
                    <p class="lead mb-0">Dynamic Arabic Phonological Analysis Engine v2.0</p>
                </div>
                <div class="col-md-3">
                    <div class="stats-card">
                        <h6>إحصائيات التحليل</h6>
                        <div class="row text-center">
                            <div class="col-4">
                                <div class="stat-number" id="totalAnalyses">0</div>
                                <div class="stat-label">تحليل</div>
                            </div>
                            <div class="col-4">
                                <div class="stat-number" id="totalChars">0</div>
                                <div class="stat-label">حرف</div>
                            </div>
                            <div class="col-4">
                                <div class="stat-number" id="cacheSize">0</div>
                                <div class="stat-label">مخزن</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-3 text-end">
                    <div class="feature-badges">
                        <span class="badge bg-success fs-6 mb-1">
                            <i class="fas fa-bolt me-1"></i>
                            Real-time
                        </span><br>
                        <span class="badge bg-info fs-6 mb-1">
                            <i class="fas fa-memory me-1"></i>
                            Cached
                        </span><br>
                        <span class="badge bg-warning text-dark fs-6">
                            <i class="fas fa-chart-line me-1"></i>
                            Analytics
                        </span>
                    </div>
                </div>
            </div>
        </header>

        <div class="row">
            <!-- Enhanced Input Panel -->
            <div class="col-lg-4">
                <!-- Main Input Card -->
                <div class="card shadow-sm mb-4 input-card">
                    <div class="card-header bg-info text-white">
                        <h5 class="mb-0">
                            <i class="fas fa-keyboard me-2"></i>
                            إدخال النص - Text Input
                        </h5>
                        <div class="analysis-mode-toggle mt-2">
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="realtimeMode" checked>
                                <label class="form-check-label" for="realtimeMode">
                                    التحليل الفوري - Real-time Analysis
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                        <form id="analysisForm">
                            <div class="mb-3">
                                <label for="arabicText" class="form-label">النص العربي المُشكَّل:</label>
                                <div class="input-group">
                                    <textarea 
                                        class="form-control arabic-input" 
                                        id="arabicText" 
                                        rows="6" 
                                        placeholder="اكتب النص العربي هنا... (مثال: أَكَلَ الوَلَدُ التُّفاحَ)"
                                        style="font-size: 18px;"
                                    >أَكَلَ الوَلَدُ التُّفاحَ</textarea>
                                    <button class="btn btn-outline-secondary" type="button" id="clearText">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                                <div class="text-counter mt-1">
                                    <small class="text-muted">الأحرف: <span id="charCount">0</span> | الكلمات: <span id="wordCount">0</span></small>
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-8">
                                    <button type="submit" class="btn btn-primary btn-lg w-100" id="analyzeBtn">
                                        <i class="fas fa-cogs me-2"></i>
                                        <span id="analyzeText">تحليل النص</span>
                                    </button>
                                </div>
                                <div class="col-4">
                                    <button type="button" class="btn btn-outline-danger w-100" id="stopAnalysis" style="display: none;">
                                        <i class="fas fa-stop"></i>
                                    </button>
                                </div>
                            </div>
                        </form>
                        
                        <!-- Enhanced Progress Indicator -->
                        <div id="progressContainer" class="mt-3" style="display: none;">
                            <div class="progress-wrapper">
                                <div class="d-flex justify-content-between align-items-center mb-2">
                                    <span id="progressLabel" class="small">جاري التحليل...</span>
                                    <span id="progressPercent" class="small text-muted">0%</span>
                                </div>
                                <div class="progress" style="height: 8px;">
                                    <div id="progressBar" class="progress-bar progress-bar-striped progress-bar-animated" 
                                         role="progressbar" style="width: 0%"></div>
                                </div>
                                <div id="processingStep" class="small text-muted mt-1"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Quick Examples -->
                <div class="card shadow-sm mb-4">
                    <div class="card-header bg-secondary text-white">
                        <h6 class="mb-0">
                            <i class="fas fa-lightbulb me-2"></i>
                            أمثلة سريعة - Quick Examples
                        </h6>
                    </div>
                    <div class="card-body">
                        <div id="examplesContainer">
                            <div class="example-category mb-3">
                                <h6 class="example-category-title">مبتدئ - Beginner</h6>
                                <button class="btn btn-outline-secondary btn-sm mb-2 w-100 example-btn" 
                                        data-text="السَّلامُ عَلَيْكُم" data-difficulty="beginner">
                                    السَّلامُ عَلَيْكُم
                                </button>
                                <button class="btn btn-outline-secondary btn-sm mb-2 w-100 example-btn" 
                                        data-text="مَرْحَباً بِالعالَم" data-difficulty="beginner">
                                    مَرْحَباً بِالعالَم
                                </button>
                            </div>
                            <div class="example-category">
                                <h6 class="example-category-title">متقدم - Advanced</h6>
                                <button class="btn btn-outline-secondary btn-sm mb-2 w-100 example-btn" 
                                        data-text="نَحْنُ نَتَعَلَّمُ العَرَبِيَّة" data-difficulty="advanced">
                                    نَحْنُ نَتَعَلَّمُ العَرَبِيَّة
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Settings Panel -->
                <div class="card shadow-sm">
                    <div class="card-header bg-dark text-white">
                        <h6 class="mb-0">
                            <i class="fas fa-cog me-2"></i>
                            الإعدادات - Settings
                        </h6>
                    </div>
                    <div class="card-body">
                        <div class="settings-group">
                            <label class="form-label">خيارات التحليل:</label>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="enableCache" checked>
                                <label class="form-check-label" for="enableCache">
                                    استخدام التخزين المؤقت
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="showProgress" checked>
                                <label class="form-check-label" for="showProgress">
                                    إظهار تقدم التحليل
                                </label>
                            </div>
                        </div>
                        
                        <hr>
                        
                        <div class="settings-group">
                            <button class="btn btn-outline-warning btn-sm w-100 mb-2" id="clearCacheBtn">
                                <i class="fas fa-broom me-1"></i>
                                مسح التخزين المؤقت
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Enhanced Results Panel -->
            <div class="col-lg-8">
                <!-- Results Container -->
                <div id="resultsContainer" style="display: none;">
                    <!-- Processing Info -->
                    <div class="card shadow-sm mb-4">
                        <div class="card-body">
                            <div class="row text-center">
                                <div class="col-md-3">
                                    <div class="metric">
                                        <i class="fas fa-clock text-primary"></i>
                                        <div class="metric-value" id="processingTime">0ms</div>
                                        <div class="metric-label">وقت المعالجة</div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="metric">
                                        <i class="fas fa-font text-success"></i>
                                        <div class="metric-value" id="phonemeCount">0</div>
                                        <div class="metric-label">الوحدات الصوتية</div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="metric">
                                        <i class="fas fa-layer-group text-info"></i>
                                        <div class="metric-value" id="syllableCount">0</div>
                                        <div class="metric-label">المقاطع</div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="metric">
                                        <i class="fas fa-memory text-warning"></i>
                                        <div class="metric-value" id="cacheStatus">جديد</div>
                                        <div class="metric-label">حالة التخزين</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Normalized Text -->
                    <div class="card shadow-sm mb-4">
                        <div class="card-header bg-warning">
                            <h5 class="mb-0">
                                <i class="fas fa-filter me-2"></i>
                                النص المعياري - Normalized Text
                            </h5>
                        </div>
                        <div class="card-body">
                            <div id="normalizedText" class="alert alert-light arabic-text"></div>
                        </div>
                    </div>

                    <!-- Phoneme Analysis -->
                    <div class="card shadow-sm mb-4">
                        <div class="card-header bg-success text-white">
                            <h5 class="mb-0">
                                <i class="fas fa-search me-2"></i>
                                التحليل الصوتي - Phoneme Analysis
                            </h5>
                        </div>
                        <div class="card-body">
                            <div id="phonemeAnalysis" class="row"></div>
                        </div>
                    </div>

                    <!-- Syllable Encoding -->
                    <div class="card shadow-sm mb-4">
                        <div class="card-header bg-info text-white">
                            <h5 class="mb-0">
                                <i class="fas fa-code me-2"></i>
                                ترميز المقاطع - Syllable Encoding
                            </h5>
                        </div>
                        <div class="card-body">
                            <div id="syllableEncoding" class="table-responsive"></div>
                        </div>
                    </div>
                </div>

                <!-- Error Container -->
                <div id="errorContainer" class="alert alert-danger" style="display: none;">
                    <h5>
                        <i class="fas fa-exclamation-triangle me-2"></i>
                        خطأ - Error
                    </h5>
                    <p id="errorMessage"></p>
                </div>

                <!-- Welcome Message -->
                <div id="welcomeMessage" class="text-center">
                    <div class="jumbotron bg-light p-5 rounded">
                        <h2 class="display-6 text-muted">مرحباً بك في محرك التحليل الصوتي الديناميكي</h2>
                        <p class="lead text-muted">
                            أدخل النص العربي في الحقل الجانبي واضغط "تحليل" للحصول على:
                        </p>
                        <ul class="list-unstyled text-muted">
                            <li><i class="fas fa-check text-success me-2"></i>تطبيع النص العربي</li>
                            <li><i class="fas fa-check text-success me-2"></i>تحليل الوحدات الصوتية</li>
                            <li><i class="fas fa-check text-success me-2"></i>ترميز المقاطع الصوتية</li>
                            <li><i class="fas fa-check text-success me-2"></i>تصنيف مورفولوجي للحروف</li>
                            <li><i class="fas fa-check text-success me-2"></i>التحليل الفوري والتخزين المؤقت</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>
